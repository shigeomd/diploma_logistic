#Область ОбработчикиКомандФормы
&НаКлиенте
Процедура ПроверитьПодключение(Команда)
	ПроверитьПодключениеНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура ВыгрузитьДанные(Команда)
	ВыгрузитьДанныеНаСервере();
КонецПроцедуры
#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура ПроверитьПодключениеНаСервере()
	СтруктураРезультатВыполнения = ЛогистикаСинхронизацияСервер.ИнициализацияПросмотр(Объект.АдресСервера);    
	Если СтруктураРезультатВыполнения.Успех Тогда
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Подключение успешно установлено");
	Иначе
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Ошибка: " + СтруктураРезультатВыполнения.ОписаниеОшибки);	
		Возврат;
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ВыгрузитьДанныеНаСервере()
	Если Объект.Назначение = Перечисления.НазначениеУзлаОбмена.Справочники Тогда
		ЛогистикаСинхронизацияСервер.ВыгрузитьСправочникиНаСервер();
	КонецЕсли;
КонецПроцедуры
#КонецОбласти

